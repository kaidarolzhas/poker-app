<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Poker Game</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link crossorigin="anonymous" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
          integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" rel="stylesheet">
    <script src="bower_components/angular/angular.min.js"></script>
    <script src="bower_components/ng-stomp/dist/ng-stomp.standalone.min.js"></script>
    <style>
        :root {
            --table-green: #2e7d32;
            --player-blue: #1e88e5;
            --folded-gray: #9e9e9e;
        }

        body {
            background: #121212;
            color: #fff;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .navbar {
            margin-bottom: 1rem;
        }

        .dashboard {
            background-color: #333;
            padding: 1rem;
            border-radius: 10px;
            margin-bottom: 1rem;
        }

        .table-area {
            background-color: var(--table-green);
            border-radius: 50%;
            width: 100%;
            max-width: 700px;
            aspect-ratio: 1 / 0.6;
            position: relative;
            margin: 2rem auto;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
        }

        .player, .foldedPlayer {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            position: absolute;
            font-size: 0.8rem;
            padding: 0.2rem;
        }

        .player {
            background-color: var(--player-blue);
        }

        .foldedPlayer {
            background-color: var(--folded-gray);
        }

        .commonCards, .potAmount {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
        }

        .commonCards {
            top: 40%;
        }

        .potAmount {
            top: 60%;
            color: #fff;
        }

        .cardimg {
            height: 80px;
            width: auto;
            margin: 0 0.2rem;
        }

        .playerLabel, .playerChipsLabel {
            margin: 0;
        }

        @media (max-width: 768px) {
            .table-area {
                max-width: 90vw;
            }

            .dashboard {
                padding: 0.5rem;
            }

            .cardimg {
                height: 60px;
            }
        }
    </style>
</head>
<body ng-app="poker" ng-controller="controller as $ctrl">

<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container-fluid">
        <a class="navbar-brand" href="#">Poker</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ms-auto">
                <li class="nav-item">
                    <a class="nav-link" href="/">Play</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/logout">Logout</a>
                </li>
            </ul>
        </div>
    </div>
</nav>

<div class="container">
    <div class="dashboard">
        <h5>Player: {{player}}</h5>
        <div ng-if="currentGameData.personalCards[0]">
            <p>Your Cards:</p>
            <div>
                <img class="cardimg" ng-repeat="card in currentGameData.personalCards" ng-src="{{ $ctrl.getCardUrl(card.rank, card.suit) }}" />
            </div>
        </div>

        <div class="input-group my-2" ng-if="currentGameData.turnNotification" ng-repeat="option in currentGameData.turnNotification.options">
            <input class="form-control" ng-if="option === 'RAISE' || option === 'BET'" ng-model="$ctrl.raiseBet">
            <button class="btn btn-primary" ng-click="submitTurn(option)">
                {{option}} {{(option == 'CALL') ? $ctrl.bet : ''}}
            </button>
        </div>
    </div>

    <div class="table-area position-relative">
        <div ng-repeat="player in currentGameData.players" class="player" ng-class="{'foldedPlayer': currentGameData.folded[player.name]}" style="top: {{30 + 30 * Math.sin($index * 2 * 3.14 / currentGameData.players.length)}}%; left: {{50 + 40 * Math.cos($index * 2 * 3.14 / currentGameData.players.length)}}%;">
            <p class="playerLabel">{{player.name}}</p>
            <p class="playerChipsLabel" ng-bind="player.chips"></p>
        </div>

        <div class="commonCards">
            <img class="cardimg" ng-repeat="card in currentGameData.commonCards" ng-src="{{ $ctrl.getCardUrl(card.rank, card.suit) }}" />
        </div>

        <div class="potAmount">
            <p ng-repeat="sidePot in currentGameData.sidePots">Side pot: {{sidePot.amount}}</p>
            <p>Main pot: {{currentGameData.pot}}</p>
        </div>
    </div>
</div>

<!-- Modals -->
<div class="modal fade" id="winnerModal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Winner</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p id="winnerText"></p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Ok</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="errorModal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Error</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p id="errorText"></p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Ok</button>
            </div>
        </div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
<script src="poker.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
<script src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
</body>
</html>
